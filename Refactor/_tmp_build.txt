        endog_array = self._as_float_array(endog, "endog", ndim=2)
        if np.isnan(endog_array).any():
            raise ValueError("`endog` contains NaN values. Please clean the data before fitting.")

        if weights is None:
            weights_array = np.ones_like(endog_array, dtype=float)
        else:
            weights_array = self._as_float_array(weights, "weights", ndim=2)
            if weights_array.shape != endog_array.shape:
                raise ValueError("`weights` must have shape (n_obs, n_series).")

        exog_dict = self._process_exog(endog_array, exog)
